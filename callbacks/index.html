<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>The pymata-cpx API - pymata-cpx and FirmataCPx</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Circuit Playground Express Input Sensors", url: "#_top", children: [
          ]},
          {title: "The API Input Device Start And Stop Methods", url: "#the-api-input-device-start-and-stop-methods", children: [
          ]},
          {title: "Understanding Callbacks", url: "#understanding-callbacks", children: [
          ]},
          {title: "Understanding The Callback Data", url: "#understanding-the-callback-data", children: [
          ]},
          {title: "Pin Numbers", url: "#pin-numbers", children: [
              {title: "Digital Inputs", url: "#digital-inputs" },
              {title: "Analog Inputs", url: "#analog-inputs" },
          ]},
          {title: "The Circuit Playground Express Output Actuators", url: "#the-circuit-playground-express-output-actuators", children: [
          ]},
          {title: "The Examples", url: "#the-examples", children: [
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../help/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../help/" class="btn btn-xs btn-link">
        Need Help?
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../firmware/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../firmware/" class="btn btn-xs btn-link">
        The FirmataCPx Host Firmware
      </a>
    </div>
    
  </div>

    

    <div style="text-align:left;color:#990033; font-family:times, serif; font-size:3.0em">The pymata-cpx API</div>

<p><br>
You may view the complete pymata-cpx API by clicking on
<a href="https://htmlpreview.github.io/?https://github.com/MrYsLab/pymata-cpx/blob/master/docs/api.html">this link.</a>
The API supports both the Circuit Playground Express input sensors and
output devices. Let's start by exploring the input sensors.</p>
<h2 id="circuit-playground-express-input-sensors">Circuit Playground Express Input Sensors</h2>
<p>Below is the list of the Circuit Playground Express input devices
supported by pymata-cpx:</p>
<ul>
<li>The Accelerometer</li>
<li>The Push Buttons And Slide Switch</li>
<li>The Touchpad Sensors</li>
<li>The Light Sensor</li>
<li>The Temperature Sensor</li>
<li>The Sound Sensor</li>
<li>The Tap Sensor</li>
</ul>
<h2 id="the-api-input-device-start-and-stop-methods">The API Input Device Start And Stop Methods</h2>
<p>All of these devices have two methods associated with them. One to start
continuous reporting for the sensor, and the second to stop
continuous reporting.</p>
<p>For example, to continuously receive change reports for Button B, call</p>
<p><strong>cpx_button_b_start</strong> </p>
<p>All the <em>start</em> methods require that you provide a callback method.
When the sensor changes value, the callback is invoked with information about the 
change. More about this in a moment.</p>
<p>If you no longer wish to receive change notifications, call the <em>stop</em> method for the sensor.
Continuing with using Button B as an example, to discontinue Button B from sending value change
notifications, call:</p>
<p><strong>cpx_button_b_stop</strong></p>
<h2 id="understanding-callbacks">Understanding Callbacks</h2>
<p>When using any of the input device <strong>start</strong> methods, you must provide a
callback method. The callback method is a method that you write to accept 
sensor change notifications. The format for all input callback methods is the same. If
a callback is created with the name <strong><em>my_callback</em></strong>, its signature
looks as follows : </p>
<p><strong>my_callback(data)</strong><br></p>
<p>The data parameter is provided to the callback method in the form of a
list. The length of the list and the data it contains varies depending
upon which input device generated the report. </p>
<p>You may specify a separate callback for each of the input devices you've
enabled, or you can share a callback across multiple sensors. The choice
is yours.</p>
<h2 id="understanding-the-callback-data">Understanding The Callback Data</h2>
<p>For each input device type, the API specifies the list data received by
the callback method. The format for the data is as follows:</p>
<p><strong>Index 0</strong> is the <strong>pin type</strong> for the input device. A value of
<strong>32</strong> indicates that this is a digital type device, and a value of <strong>2</strong>
indicates that this device is an analog device. Knowing the pin type is useful
if you wish to have your callback method handle multiple sensors. </p>
<p><strong>Index 1</strong> is the internal pin number for the device. See the tables below.</p>
<p><strong>Index 2 and above</strong>* contain the data value of the sensor. The data is sensor dependent.</p>
<p>For each <strong>start</strong> method, there is a comment in the API that describes the format for the
data parameter that will be provided when your callback method is invoked.</p>
<p>For example, looking at the API entry for <a href="https://htmlpreview.github.io/?https://github.com/MrYsLab/pymata-cpx/blob/master/docs/api.html#pymata_cpx.PyMataCpx.cpx_button_b_start">cpx_button_b_start</a>
, here is what you would see:</p>
<pre><code class="python"> def cpx_button_b_start(self, callback)

    Enable button and report state changes in the callback.

    :param callback: a list of values described below.

    Parameters sent to callback:

    [Digital Pin Type: 32, Pin Number: 5, switch value: 1 if pressed zero if released.]

</code></pre>

<p>The last line describes the values placed in the data parameter for the callback method. We would expect to see
a list that contains: [32, 5, DATA_VALUE], where DATA_VALUE is either a zero or 1.</p>
<p>Let's look at an example that returns multiple values. Here is the API entry for receiving notification 
of changes to a 
<a href="https://htmlpreview.github.io/?https://github.com/MrYsLab/pymata-cpx/blob/master/docs/api.html#pymata_cpx.PyMataCpx.cpx_cap_touch_start">capacitive touch pad:</a></p>
<pre><code class="python"> def cpx_cap_touch_start(self, input_pin, callback)

    Start continuous capacitive touch queries for the specified input pin. Will invoke the provided callback each time a new cap touch result is available.

    :param input_pin: must be one of the Ax pin numbers. Use only the number.

                  example: cpx_cap_touch_start(5, a_callback_function)

    :param callback: a list of values described below.

    Parameters sent to callback:

    [Analog Pin Type: 2, Pin Number: 1-7, Touched: True or False, Raw data value]

</code></pre>

<p>For a capacitive touchpad callback, we would expect the data to look like
[2, PIN_NUMBER, BOOLEAN_STATE, RAW_DATA_VALUE]</p>
<p>Index 0 identifies the event coming from an analog device. Index 1 contains the pin number where
the change was detected. Index 2 contains either True or False to indicate the current state
of the touch sensor, and Index 3 contains the raw analog value for the sensor if you wish to use that
value.</p>
<p>All of the <strong>start</strong> methods in the API identify the items you can expect to find in the 
callback list.</p>
<h2 id="pin-numbers">Pin Numbers</h2>
<p>Here are the pin numbers you would expect to see in the callback data list for each of the sensor types.</p>
<h3 id="digital-inputs">Digital Inputs</h3>
<table>
<thead>
<tr>
<th>Digital Pin Number</th>
<th>Device</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>Button A</td>
</tr>
<tr>
<td>5</td>
<td>Button B</td>
</tr>
<tr>
<td>7</td>
<td>Slide Switch</td>
</tr>
<tr>
<td>12</td>
<td>Tap Sensor</td>
</tr>
</tbody>
</table>
<h3 id="analog-inputs">Analog Inputs</h3>
<table>
<thead>
<tr>
<th>Analog Pin Number</th>
<th>Sensor</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 - 7</td>
<td>Touchpad</td>
</tr>
<tr>
<td>8</td>
<td>Light</td>
</tr>
<tr>
<td>9</td>
<td>Temperature</td>
</tr>
<tr>
<td>10</td>
<td>Sound</td>
</tr>
<tr>
<td>11</td>
<td>Accelerometer</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="the-circuit-playground-express-output-actuators">The Circuit Playground Express Output Actuators</h2>
<p>Below is the list of the Circuit Playground Express on-board actuators supported by pymata-cpx:</p>
<ul>
<li>Red "Board LED"</li>
<li>On-board Neopixels</li>
<li>Tone Generator</li>
</ul>
<h1 id="the-examples">The Examples</h1>
<p>The best way to understand how to use the API is to see some example code.
The following table contains a link to source code for each example and a list of the sensors and actuators
that the example uses.</p>
<p>With the exception of the <em>buttons_switch_and_pixels</em> example, all of the example code is
contained within a class. If you prefer to work in a procedural style, the <em>buttons_switch_and_pixels</em>
provides an illustration of the procedural style.</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Sensors</th>
<th>Actuators</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/buttons_switch_and_pixels.py">buttons_switch_and_pixels</a></td>
<td>Button A, Button B, Slide Switch</td>
<td>Neopixels 1, 3, 6 and 8</td>
</tr>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/light_meter.py">light_meter</a></td>
<td>Light Sensor</td>
<td>All 10 Neopixels</td>
</tr>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/the_clapper.py">the clapper</a></td>
<td>Sound sensor</td>
<td>All 10 Neopixels</td>
</tr>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/the_tapper.py">the tapper</a></td>
<td>Accelorometer tap sensor</td>
<td>All 10 Neopixels</td>
</tr>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/thermometer.py">thermometer</a></td>
<td>Temperature sensor</td>
<td>All 10 Neopixels</td>
</tr>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/tilted.py">tilted</a></td>
<td>Accelerometer</td>
<td>None</td>
</tr>
<tr>
<td><a href="https://github.com/MrYsLab/pymata-cpx/blob/master/examples/touch_piano.py">touch_piano</a></td>
<td>All 7 Touchpads</td>
<td>Tone Generator</td>
</tr>
</tbody>
</table>
<p><br> <br></p>
<p>Copyright (C) 2019 Alan Yorinks. All Rights Reserved.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../help/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../help/" class="btn btn-xs btn-link">
        Need Help?
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../firmware/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../firmware/" class="btn btn-xs btn-link">
        The FirmataCPx Host Firmware
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>